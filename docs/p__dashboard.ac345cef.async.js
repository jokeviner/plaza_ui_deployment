(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[465],{94916:function(g,y,o){"use strict";o.r(y),o.d(y,{default:function(){return R}});var d=o(72560);function S(u){if(Array.isArray(u))return(0,d.Z)(u)}function j(u){if(typeof Symbol!="undefined"&&u[Symbol.iterator]!=null||u["@@iterator"]!=null)return Array.from(u)}var T=o(64254);function b(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function E(u){return S(u)||j(u)||(0,T.Z)(u)||b()}var m=o(11849),P=o(2824),C=o(67294),W=o(45840),Q=o(68311),c=o(85893),Z=function(w){var x=w.dataSource,D=function(p){var l=[];return p.forEach(function(f,A){var v=f.data;l.push({coin:f.coin,index:A+1,symbol:v[0].name,spotPrice:v[0].price,fPrice:v[1].price,fSymbol:v[1].name,margin:+((v[1].price-v[0].price)/v[0].price*100).toFixed(2),t:f.t,d:f.d})}),l}(x),I=[{title:"\u6392\u5E8F",dataIndex:"index",valueType:"indexBorder",width:48},{title:"\u4EA4\u6613\u5BF9",dataIndex:"symbol",render:function(l,f){return(0,c.jsxs)(c.Fragment,{children:[l," ",(0,c.jsx)("span",{style:{fontSize:"smaller",color:"lightgray"},children:f.fSymbol})]})},width:200},{title:"\u73B0\u8D27\u4EF7\u683C",dataIndex:"spotPrice",width:100},{title:"\u5408\u7EA6\u4EF7\u683C",dataIndex:"fPrice",width:100},{title:"\u5408\u7EA6\u7C7B\u578B",dataIndex:"t",valueEnum:{d:"\u5E01\u672C\u4F4D CM",f:"U\u672C\u4F4D"},filters:!0,onFilter:!0},{title:"Margin",dataIndex:"margin",sorter:function(l,f){return l.margin-f.margin},renderText:function(l){return l==-100?"-":"".concat(l,"%")}},{title:"\u671F\u9650",dataIndex:"d",valueEnum:{q:"\u5F53\u5B63",n:"\u6B21\u5B63",p:"\u6C38\u7EED"},filters:!0,onFilter:!0},{title:"\u64CD\u4F5C",dataIndex:"option",valueType:"option",render:function(){return[(0,c.jsx)("a",{children:"\u7F16\u8F91"},"edit"),(0,c.jsx)("a",{children:"\u5220\u9664"},"delete")]}}];return(0,c.jsx)("div",{children:(0,c.jsx)(Q.Z,{columns:I,dataSource:D,rowKey:"index",search:!1,pagination:!1,options:!1})})},U=Z,K=function(){var w=[],x=[],D=[],I=(0,C.useState)(!1),p=(0,P.Z)(I,2),l=p[0],f=p[1],A=function(){for(var e=new Date,t=e.getFullYear(),a=e.getMonth()+1,n=a-a%3,s=new Date(t,n,0).getDate(),r=new Date(t,n-1,s);r.getDay()!==5;)r.setDate(r.getDate()-1);var i="".concat(t.toString().slice(-2)).concat(a.toString().padStart(2,"0")).concat(r.getDate().toString().padStart(2,"0"));return i},v=function(){for(var e=new Date,t=e.getFullYear(),a=e.getMonth()+1,n=a+3-a%3,s=new Date(t,n,0).getDate(),r=new Date(t,n-1,s);r.getDay()!==5;)r.setDate(r.getDate()-1);var i="".concat(t.toString().slice(-2)).concat(n.toString().padStart(2,"0")).concat(r.getDate().toString().padStart(2,"0"));return i},k=A(),N=v();console.log(k,N);var H={spot:"wss://stream.binance.com:9443",futures:"wss://fstream.binance.com",delivery:"wss://dstream.binance.com"},Y=(0,C.useState)([]),O=(0,P.Z)(Y,2),F=O[0],z=O[1],G=function(e,t){var a=e.s,n=parseFloat(e.p),s=e.T,r="s";switch(t){case"spot":r="s";break;case"futures":r="f";break;case"delivery":r="d";break}F.forEach(function(i,$){r==="s"&&i.data[0].name===a?(i.data[0].price=n,i.data[0].time=s):r===i.t&&i.data[1].name===a&&(i.data[1].price=n,i.data[1].time=s)})},L=function(e,t){if(t.length!==0){var a=t.map(function(r){return"".concat(r.toLowerCase(),"@aggTrade")}).join("/"),n=H[e]+"/stream?streams="+a,s=new W.w3cwebsocket(n);s.onopen=function(){console.log("WebSocket connection established for ".concat(e,",and the symbols are ").concat(t))},s.onclose=function(){console.log("WebSocket connection closed for ".concat(e))},s.onmessage=function(r){var i=JSON.parse(r.data);i==="Ping"?s.send("Pong"):G(i.data,e)}}},X=function(e){var t=M(e),a=(0,m.Z)((0,m.Z)({},e),{},{data:[{name:t.s,price:0,time:0},{name:t.f,price:0,time:0}]});return a},J=function(){var e=[];return["BTC","ETH","BCH","LINK","BNB","DOT","ADA","LTC","XPR"].forEach(function(t){["d","f"].forEach(function(a){["BCH","LINK","BNB","DOT","ADA","LTC","XPR"].indexOf(t)&&a=="f"||["q","n","p"].forEach(function(n){e.push({coin:t,s:t+"USDT",f:t+(a=="d"?"USD":"USDT"),t:a,d:n})})})}),e},B=J(),M=function(e){var t="";return e.d==="q"?t="_"+k:e.d==="n"?t="_"+N:e.t==="d"&&e.d==="p"&&(t="_PERP"),{s:e.s,f:e.f+t}},V=function(e){w=[],x=[],D=[],e.forEach(function(t,a){var n=M(t);t.t==="d"?D.push(n.f):t.t==="f"&&x.push(n.f),w.push(n.s)})};return(0,C.useEffect)(function(){console.log("init"),B.forEach(function(e,t){F.push(X(e))}),console.log(F),V(B),L("spot",w),L("futures",x),L("delivery",D);var h=setInterval(function(){z(E(F))},1e3);return function(){clearInterval(h)}},[]),(0,c.jsxs)("div",{children:[(0,c.jsx)("h3",{children:"\u6570\u636E\u4E3A\u5B9E\u65F6\u6700\u65B0\u6210\u4EA4\u6570\u636E\uFF0C\u5982\u679C\u6570\u636E\u4E3A0\uFF0C\u8BF4\u660E\u6682\u65F6\u672A\u6709\u6210\u4EA4\u8BB0\u5F55"}),(0,c.jsx)(U,{dataSource:F})]})},R=K},284:function(g){var y=function(){if(typeof self=="object"&&self)return self;if(typeof window=="object"&&window)return window;throw new Error("Unable to resolve global `this`")};g.exports=function(){if(this)return this;if(typeof globalThis=="object"&&globalThis)return globalThis;try{Object.defineProperty(Object.prototype,"__global__",{get:function(){return this},configurable:!0})}catch(o){return y()}try{return __global__||y()}finally{delete Object.prototype.__global__}}()},45840:function(g,y,o){var d;if(typeof globalThis=="object")d=globalThis;else try{d=o(284)}catch(b){}finally{if(!d&&typeof window!="undefined"&&(d=window),!d)throw new Error("Could not determine global this")}var S=d.WebSocket||d.MozWebSocket,j=o(79387);function T(b,E){var m;return E?m=new S(b,E):m=new S(b),m}S&&["CONNECTING","OPEN","CLOSING","CLOSED"].forEach(function(b){Object.defineProperty(T,b,{get:function(){return S[b]}})}),g.exports={w3cwebsocket:S?T:null,version:j}},79387:function(g,y,o){g.exports=o(12847).version},12847:function(g){"use strict";g.exports={version:"1.0.34"}}}]);
